#!/bin/sh

if [ $# -eq 1 ]
  head_branch=$1
else
  head_branch=origin/develop
fi
for b in $(git branch | grep "^ "); do
  echo "==== START $b ===="
  completed="[32m===== COMPLETED $b =====[m"
  failed="[34m FAILED $b[m"
  git checkout $b
  # _no_push=(git rebase ... && echo $completed) && echo OK || (git rebase --abort && echo $failed)
  (git rebase $head_branch && echo $completed) && read x && [ "$x" = "y" ] && git push -f || (git rebase --abort && echo $failed)
done
